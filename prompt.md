# BizCard

これは、署名アルゴリズムを使用して、名刺の対象者がその時にその場所に存在していたことを証明するためのものです。

## 技術
フレームワークはSvelteKitを使用します.
署名アルゴリズムはECDSAを使用します。楕円曲線は、P-521を使用します。
署名および検証は、Web Crypto APIを使用します。
MEMO: AIは、ロジック部分を実装し、インターフェースは簡易的なものにしてください。そこは人間がやります。

## /card
このエンドポイントは、名刺を実際に表示するためのものです。
ここでは、以下の手順を行います。
1. 秘密鍵をローカルから取得します。
2. デバイスの位置情報を取得します。緯度経度ともに少数店以下3桁まで取得します。
3. 現在の日時を取得します。これは、ISO 8601形式の文字列で取得します。なお、タイムゾーンはUTCで取得します。
4. 以下のようにペイロードを作成します。
   ```json
   {
     "latitude": 35.6895,
     "longitude": 139.6917,
     "timestamp": "2023-10-01T12:00:00Z",
     "message": ""
   }
   ```
("message"には事前にサーバー側で設定される文字列が入ります。)
5. ペイロードをJSON文字列に変換します。
6. JSON文字列をUTF-8エンコードします。
7. エンコードしたバイト列を秘密鍵で署名します。
8. 署名をBase64エンコードします。
9. 署名を含む名刺のHTMLを生成します。
10. 生成したHTMLを返します。

## /verify
このエンドポイントは、名刺の署名を検証するためのものです
。ここでは、以下の手順を行います。
1. ユーザーは、署名に記載されている緯度、経度、タイムスタンプを入力します。
2. ユーザーは、署名を入力します。
3. 公開鍵はサーバー側に保管されているものを取得します。
4. 入力された緯度、経度、タイムスタンプを使用してペイロードを作成します。
   ```json
   {
     "latitude": 35.6895,
     "longitude": 139.6917,
     "timestamp": "2023-10-01T12:00:00Z",
     "message": ""
   }
   ```
("message"には事前にサーバー側で設定される文字列が入ります。)
5. ペイロードをJSON文字列に変換します。
6. JSON文字列をUTF-8エンコードします。
7. エンコードしたバイト列を公開鍵で検証します。
8. 検証結果を返します。成功した場合は、署名が有効であることを示すメッセージを返します。失敗した場合は、署名が無効であることを示すメッセージを返します。


# サーバー側の情報
サーバーは以下の情報を持ちます：
- 公開鍵
- 署名に使用するメッセージ
秘密鍵はクライアント側でのみ使用され、サーバーには保存されません。
なお、このプロジェクトはオープンソースであり、公開鍵とメッセージはハードコーディングなされてはいけません。設定ファイルにより、管理される必要があります。
メッセージは@/config/message.jsonに保存されます。
```json
{
    "message": "mersnn621"
}
```
公開鍵は、ECDSA P-521を使用して生成され、PEM形式で保存されます。
公開鍵は、@/config/publickey.pemに保存されます。
署名および検証は、Web Crypto APIを使用して行われます。サーバー側では一切の署名や検証は行われません。クライアント側でのみ行われます。